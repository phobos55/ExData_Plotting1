seBeta0<-(1/n+mean(x)^2/ssx)^.5*sigma
seBeta1<-sigma/sqrt(ssx)
tBeta0<-beta0/seBeta0;tBeta1<-beta1/seBeta1
pBeta0<-2*pt(abs(tBeta0),df=n-2,lower.tail=FALSE)
pBeta1<-2*pt(abs(tBeta1),df=n-2,lower.tail=FALSE)
coefTable<-rbind(c(beta0,seBeta0,tBeta0,pBeta0),c(beta1,seBeta1,tBeta1,pBeta1))
colnames(coefTable)<-c("Estimate","Std.Error","tvalue","P(>|t|)")
rownames(coefTable)<-c("(Intercept)","x")
plot(x,y,frame=FALSE,xlab="Carat",ylab="Dollars",pch=21,col="black",bg="lightblue",cex=2)
abline(fit,lwd=2)
xVals<-seq(min(x),max(x),by=.01)
yVals<-beta0+beta1*xVals
se1<-sigma*sqrt(1/n+(xVals-mean(x))^2/ssx)
se2<-sigma*sqrt(1+1/n+(xVals-mean(x))^2/ssx)
lines(xVals,yVals+2*se1,col="red")
lines(xVals,yVals-2*se1,col="red")
lines(xVals,yVals+2*se2,col="green")
lines(xVals,yVals-2*se2,col="green")
beta1<-cor(y,x)*sd(y)/sd(x)
beta0<-mean(y)-beta1*mean(x)
e<-y-beta0-beta1*x
sigma<-sqrt(sum(e^2)/(n-2))
ssx<-sum((x-mean(x))^2)
seBeta0<-(1/n+mean(x)^2/ssx)^.5*sigma
seBeta1<-sigma/sqrt(ssx)
tBeta0<-beta0/seBeta0;tBeta1<-beta1/seBeta1
pBeta0<-2*pt(abs(tBeta0),df=n-2,lower.tail=FALSE)
pBeta1<-2*pt(abs(tBeta1),df=n-2,lower.tail=FALSE)
coefTable<-rbind(c(beta0,seBeta0,tBeta0,pBeta0),c(beta1,seBeta1,tBeta1,pBeta1))
colnames(coefTable)<-c("Estimate","Std.Error","tvalue","P(>|t|)")
rownames(coefTable)<-c("(Intercept)","x")
plot(x,y,frame=FALSE,xlab="Carat",ylab="Dollars",pch=21,col="black",bg="lightblue",cex=2)
abline(fit,lwd=2)
xVals<-seq(min(x),max(x),by=.01)
yVals<-beta0+beta1*xVals
se1<-sigma*sqrt(1/n+(xVals-mean(x))^2/ssx)
se2<-sigma*sqrt(1+1/n+(xVals-mean(x))^2/ssx)
lines(xVals,yVals+2*se1,col="red")
lines(xVals,yVals-2*se1,col="red")
lines(xVals,yVals+2*se2,col="green dark")
lines(xVals,yVals-2*se2,col="green dark")
beta1<-cor(y,x)*sd(y)/sd(x)
beta0<-mean(y)-beta1*mean(x)
e<-y-beta0-beta1*x
sigma<-sqrt(sum(e^2)/(n-2))
ssx<-sum((x-mean(x))^2)
seBeta0<-(1/n+mean(x)^2/ssx)^.5*sigma
seBeta1<-sigma/sqrt(ssx)
tBeta0<-beta0/seBeta0;tBeta1<-beta1/seBeta1
pBeta0<-2*pt(abs(tBeta0),df=n-2,lower.tail=FALSE)
pBeta1<-2*pt(abs(tBeta1),df=n-2,lower.tail=FALSE)
coefTable<-rbind(c(beta0,seBeta0,tBeta0,pBeta0),c(beta1,seBeta1,tBeta1,pBeta1))
colnames(coefTable)<-c("Estimate","Std.Error","tvalue","P(>|t|)")
rownames(coefTable)<-c("(Intercept)","x")
plot(x,y,frame=FALSE,xlab="Carat",ylab="Dollars",pch=21,col="black",bg="lightblue",cex=2)
abline(fit,lwd=2)
xVals<-seq(min(x),max(x),by=.01)
yVals<-beta0+beta1*xVals
se1<-sigma*sqrt(1/n+(xVals-mean(x))^2/ssx)
se2<-sigma*sqrt(1+1/n+(xVals-mean(x))^2/ssx)
lines(xVals,yVals+2*se1,col="red")
lines(xVals,yVals-2*se1,col="red")
lines(xVals,yVals+2*se2,col=4)
lines(xVals,yVals-2*se2,col=4)
newdata<-data.frame(x=xVals)
p1<-predict(fit,newdata,interval=("confidence"))
p2<-predict(fit,newdata,interval=("prediction"))
plot(x,y,frame=FALSE,xlab="Carat",ylab="Dollars",pch=21,col="black",bg="lightblue",cex=2)
abline(fit,lwd=2)
lines(xVals,p1[,2]);lines(xVals,p1[,3])
lines(xVals,p2[,2]);lines(xVals,p2[,3])
newdata<-data.frame(x=xVals)
p1<-predict(fit,newdata,interval=("confidence"))
p2<-predict(fit,newdata,interval=("prediction"))
plot(x,y,frame=FALSE,xlab="Carat",ylab="Dollars",pch=21,col="black",bg="lightblue",cex=2)
abline(fit,lwd=2)
lines(xVals,p1[,2]);lines(xVals,p1[,3])
lines(xVals,p2[,2]);lines(xVals,p2[,3])
newdata<-data.frame(x=xVals)
p1<-predict(fit,newdata,interval=("confidence"))
p2<-predict(fit,newdata,interval=("prediction"))
plot(x,y,frame=FALSE,xlab="Carat",ylab="Dollars",pch=21,col="black",bg="lightblue",cex=2)
abline(fit,lwd=2)
lines(xVals,p1[,2],col="red");lines(xVals,p1[,3],col="red")
lines(xVals,p2[,2],col=4);lines(xVals,p2[,3],col=4)
x <- c(0.61, 0.93, 0.83, 0.35, 0.54, 0.16, 0.91, 0.62, 0.62)
y <- c(0.67, 0.84, 0.6, 0.18, 0.85, 0.47, 1.1, 0.65, 0.36)
fit<-lm(y~x)
summary(fit)
summary(fit)$sigma
Modelcarss<-lm(weight~mpg,data=mtcars)
data(mtcars)
Modelcarss<-lm(weight~mpg,data=mtcars)
Modelcarss<-lm(weight$mtcars~mpg~mtcars)
Modelcarss<-lm(weight$mtcars~mpg$mtcars)
str(mtcars)
Modelcarss<-lm(wt$mtcars~mpg$mtcars)
x<-wt$mtcars
x<-mtcars$wt
y<-mtcars$wt
x<-mtcars$mpg
modelcars<-lm(y~x)
sumCoef<-summary(modelcars)$coefficients
sumCoef[2,1]+c(-1,1)*qt(.975,df=modelcars$df)*sumCoef[2,2]
modelcars<-lm(x~y)
sumCoef<-summary(modelcars)$coefficients
sumCoef[2,1]+c(-1,1)*qt(.975,df=modelcars$df)*sumCoef[2,2]
summary(modelcars)
plot(x,y)
plot(y,x)
n<-100;nosim<-1000
x1<-rnorm(n);x2<-rnorm(n);x3<-rnorm(n);
betas<-sapply(1:nosim,function(i){
y<-x1+rnorm(n,sd=.3)
c(coef(lm(y~x1))[2],
coef(lm(y~x1+x2))[2],
coef(lm(y~x1+x2+x3))[2])
})
round(apply(betas,1,sd),5)
n<-100;nosim<-1000
x1<-rnorm(n);x2<-rnorm(n);x3<-rnorm(n);
betas<-sapply(1:nosim,function(i){
y<-x1+rnorm(n,sd=.3)
c(coef(lm(y~x1))[2],
coef(lm(y~x1+x2))[2],
coef(lm(y~x1+x2+x3))[2])
})
round(apply(betas,1,sd),5)
n<-100;nosim<-1000
x1<-rnorm(n);x2<-x1/sqrt(2)+rnorm(n)/sqrt(2)
x3<-x1*0.95+rnorm(n)*sqrt(1-0.95^2);
betas<-sapply(1:nosim,function(i){
y<-x1+rnorm(n,sd=.3)
c(coef(lm(y~x1))[2],
coef(lm(y~x1+x2))[2],
coef(lm(y~x1+x2+x3))[2])
})
round(apply(betas,1,sd),5)
temp <- apply(betas, 1, var); temp[2 : 3] / temp[1]
n<-100;nosim<-1000
x1<-rnorm(n);x2<-x1/sqrt(2)+rnorm(n)/sqrt(2)
x3<-x1*0.95+rnorm(n)*sqrt(1-0.95^2);
betas<-sapply(1:nosim,function(i){
y<-x1+rnorm(n,sd=.3)
c(coef(lm(y~x1))[2],
coef(lm(y~x1+x2))[2],
coef(lm(y~x1+x2+x3))[2])
})
round(apply(betas,1,sd),5)
temp <- apply(betas, 1, var); temp[2 : 3] / temp[1]
temp
data(swiss)
fit1 <- lm(Fertility ~ Agriculture, data = swiss)
a <- summary(fit1)$cov.unscaled[2,2]
fit2 <- update(fit, Fertility ~ Agriculture + Examination)
fit3 <- update(fit, Fertility ~ Agriculture + Examination + Education)
c(summary(fit2)$cov.unscaled[2,2],
summary(fit3)$cov.unscaled[2,2]) / a
data(swiss)
fit1 <- lm(Fertility ~ Agriculture, data = swiss)
a <- summary(fit1)$cov.unscaled[2,2]
fit2 <- update(fit1, Fertility ~ Agriculture + Examination)
fit3 <- update(fit2, Fertility ~ Agriculture + Examination + Education)
c(summary(fit2)$cov.unscaled[2,2],
summary(fit3)$cov.unscaled[2,2]) / a
library(car)
fit0<-lm(Fertility ~ . , data = swiss)
vif(fit)
library(car)
fit<-lm(Fertility ~ . , data = swiss)
vif(fit)
sqrt(vif(fit))
str(cars)
str(mtcars)
head(mtcars,3)
mtcars$mpg[mtcars$am==1]
mtcars$mpg[mtcars$am==0]
data(mtcars)
mean(mtcars$mpg[mtcars$am==1])
mean(mtcars$mpg[mtcars$am==0])
mean(mtcars$mpg[mtcars$am==1]) - mean(mtcars$mpg[mtcars$am==0])
plot(mtcars$mpg,mtcars$am,pch=19,col="blue")
plot(mtcars$am,mtcars$mpg,pch=19,col="blue")
pairs(mtcars, panel = panel.smooth, main = "Motor Trend Car Road Tests", col = 3 + (mtcars$am > 0))
pairs(mtcars, main = "Motor Trend Car Road Tests", col = 6 + (mtcars$am > 0))
pairs(mtcars, main = "Motor Trend Car Road Tests", col = 1 + (mtcars$am > 0))
pairs(mtcars, main = "Motor Trend Car Road Tests", col = 2 + (mtcars$am > 0))
pairs(mtcars, main = "Motor Trend Car Road Tests", col = 5 + (mtcars$am > 0))
pairs(mtcars[,-9], main = "Motor Trend Car Road Tests", col = 5 + (mtcars$am > 0))
pairs(mtcars[,-9], main = "Motor Trend Car Road Tests", col = 8 + (mtcars$am > 0))
pairs(mtcars[,-9], main = "Motor Trend Car Road Tests", col = 9 + (mtcars$am > 0))
pairs(mtcars[,-9], main = "Motor Trend Car Road Tests", col = 1 + (mtcars$am > 0))
pairs(mtcars[,-9], main = "Motor Trend Car Road Tests", col = 1 + (mtcars$am == 0))
pairs(mtcars[,-9], main = "Motor Trend Car Road Tests", col = 1 + (mtcars$am == 0),pch = 21)
pairs(mtcars[,-9], main = "Motor Trend Car Road Tests", col = 1 + (mtcars$am == 0),cex = 2)
pairs(mtcars[,-9], main = "Motor Trend Car Road Tests", col = 1 + (mtcars$am == 0),bg =2)
pairs(mtcars[,-9], main = "Motor Trend Car Road Tests", col = 1 + (mtcars$am == 0))
pairs(mtcars[,-9], main = "Motor Trend Car Road Tests", col = 1 + (mtcars$am == 0), pch = 21)
pairs(mtcars[,-9], main = "Motor Trend Car Road Tests", col = 1 + (mtcars$am == 0), pch = 19)
pairs(mtcars[,-9], main = "Motor Trend Car Road Tests", col = 1 + (mtcars$am == 0), pch = 19,cex = 2)
pairs(mtcars[,-9:11], main = "Motor Trend Car Road Tests", col = 1 + (mtcars$am == 0), pch = 19,cex = 2)
pairs(mtcars[,1:9], main = "Motor Trend Car Road Tests", col = 1 + (mtcars$am == 0), pch = 19,cex = 2)
pairs(mtcars[,1:7], main = "Motor Trend Car Road Tests", col = 1 + (mtcars$am == 0), pch = 19,cex = 2)
fit1 <- lm(Fertility ~ Agriculture, data = swiss)
fit3 <- update(fit, Fertility ~ Agriculture + Examination + Education)
fit5 <- update(fit, Fertility ~ Agriculture + Examination + Education + Catholic + Infant.Mortality)
anova(fit1, fit3, fit5)
fit<-lm(y~x)
round(dfbetas(fit)[1:10,2],3)
round(hatvalues(fit)[1:10],3)
library(datasets); data(swiss); require(stats); require(graphics)
n <- 100; t <- rep(c(0, 1), c(n/2, n/2)); x <- c(runif(n/2), runif(n/2));
beta0 <- 0; beta1 <- 2; tau <- 1; sigma <- .2
y <- beta0 + x * beta1 + t * tau + rnorm(n, sd = sigma)
plot(x, y, type = "n", frame = FALSE)
abline(lm(y ~ x), lwd = 2)
abline(h = mean(y[1 : (n/2)]), lwd = 3)
abline(h = mean(y[(n/2 + 1) : n]), lwd = 3)
fit <- lm(y ~ x + t)
abline(coef(fit)[1], coef(fit)[2], lwd = 3)
abline(coef(fit)[1] + coef(fit)[3], coef(fit)[2], lwd = 3)
points(x[1 : (n/2)], y[1 : (n/2)], pch = 21, col = "black", bg = "lightblue", cex = 2)
points(x[(n/2 + 1) : n], y[(n/2 + 1) : n], pch = 21, col = "black", bg = "salmon", cex = 2)
data(swiss);par(mfrow=c(2,2))
fit<-lm(Fertility~.,data=swiss);plot(fit)
n<-100;x<-c(10,rnorm(n));y<-c(10,c(rnorm(n)))
plot(x,y,frame=FALSE,cex=2,pch=21,bg="lightblue",col="black")
abline(lm(y~x))
n<-100;nosim<-1000
x1<-rnorm(n);x2<-rnorm(n);x3<-rnorm(n);
betas<-sapply(1:nosim,function(i){
y<-x1+rnorm(n,sd=.3)
c(coef(lm(y~x1))[2],
coef(lm(y~x1+x2))[2],
coef(lm(y~x1+x2+x3))[2])
})
round(apply(betas,1,sd),5)
n<-100;nosim<-1000
x1<-rnorm(n);x2<-x1/sqrt(2)+rnorm(n)/sqrt(2)
x3<-x1*0.95+rnorm(n)*sqrt(1-0.95^2);
betas<-sapply(1:nosim,function(i){
y<-x1+rnorm(n,sd=.3)
c(coef(lm(y~x1))[2],
coef(lm(y~x1+x2))[2],
coef(lm(y~x1+x2+x3))[2])
})
round(apply(betas,1,sd),5)
fit1 <- lm(Fertility ~ Agriculture, data = swiss)
fit3 <- update(fit1, Fertility ~ Agriculture + Examination + Education)
fit5 <- update(fit1, Fertility ~ Agriculture + Examination + Education + Catholic + Infant.Mortality)
anova(fit1, fit3, fit5)
x <- c(0.586, 0.166, -0.042, -0.614, 11.72)
y <- c(0.549, -0.026, -0.127, -0.751, 1.344)
fit<-lm(y~x)
round(hatvalues(fit)[1:10],3)
hatvalues(fit)[1:10]
dfbetas(fit)[1:10,2]
dfbetas(fit)[1:10,2
]
dfbetas(fit)
lm(mpg ~ I(wt * 0.5) + factor(cyl), data = mtcars)
x <- c(0.586, 0.166, -0.042, -0.614, 11.72)
y <- c(0.549, -0.026, -0.127, -0.751, 1.344)
fit<-lm(y~x)
fbetas(fit)
dfbetas(fit)
hatvalues(fit)
round(232433455)
options(rpubs.upload.method = "internal")
rpubsUpload
uploadFunction -> readResponse -> rawToChar -> readBin
options(rpubs.upload.method = "internal")
options(RCurlOptions = list(verbose = FALSE, capath = system.file("CurlSSL", "cacert.pem", package = "RCurl"), ssl.verifypeer = FALSE))
library("acepack", lib.loc="~/R/win-library/3.1")
install.packages("markdown")
library(markdown)
rpubsUpload(title, htmlFile, id = NULL, properties = list(), method = getOption("rpubs.upload.method", "internal"))
library("limma", lib.loc="~/R/win-library/3.1")
library("bitops", lib.loc="~/R/win-library/3.1")
library("RCurl", lib.loc="~/R/win-library/3.1")
library("rmarkdown", lib.loc="~/R/win-library/3.1")
library("knitr", lib.loc="~/R/win-library/3.1")
sessionInfo()
library("markdown", lib.loc="~/R/win-library/3.1")
library("rmarkdown", lib.loc="~/R/win-library/3.1")
detach("package:markdown", unload=TRUE)
detach("package:rmarkdown", unload=TRUE)
mtcars
mtcars$am
plot(mtcars$mpg,col=1+(mtcars$am==0)
)
plot(mtcars$mpg,mtcars$wt,col=1+(mtcars$am==0))
plot(mtcars$mpg~mtcars$wt,col=1+(mtcars$am==0))
plot(mtcars$mpg~mtcars$wt,col=1+(mtcars$am==0),pch=19,cax=2)
plot(mtcars$mpg~mtcars$wt,col=1+(mtcars$am==0),pch=19)
plot(mtcars$mpg~mtcars$wt,col=1+(mtcars$am==0),pch=19)
plot(mtcars$mpg~mtcars$wt,col=1+(mtcars$am==0),pch=19,xlab="Weight (lb/1000)",ylab="Miles/(US) gallon")
plot(mtcars$mpg~mtcars$wt,col=1+(mtcars$am==0),pch=19,xlab="Weight (lb/1000)",ylab="Miles/(US) gallon",frame=FALSE)
plot(mtcars$mpg~mtcars$wt,col=1+(mtcars$am==0),pch=19,xlab="Weight (lb/1000)",ylab="Miles/(US) gallon",frame=F)
cor(mtcars$mpg, mtcars[,-1])
head(mtcars)
cor(mtcars$mpg, mtcars[,c(-1,-2,-8,-10,-11)])
mtcars$mpg[mtcars$am==1]
mtcars$mpg[mtcars$am==0]
abline(lm(mtcars$mpg[mtcars$am==1],mtcars$wt[mtcars$am==1))
abline(lm(mtcars$mpg[mtcars$am==1],mtcars$wt[mtcars$am==1]))
mtcars$wt[mtcars$am==1]
mtcars$wt[mtcars$am==0]
mtcars$wt[mtcars$am==0,]
mtcars$wt[,mtcars$am==0]
mtcars$wt[mtcars$am==0]
abline(lm(mtcars$mpg[mtcars$am==1],mtcars$wt[mtcars$am==1]),col=2)
abline(lm(mtcars$mpg[mtcars$am==1]~mtcars$wt[mtcars$am==1]),col=2)
abline(lm(mtcars$mpg[mtcars$am==1]~mtcars$wt[mtcars$am==1]))
abline(lm(mtcars$mpg[mtcars$am==0]~mtcars$wt[mtcars$am==0]),col=2)
abline(lm(mtcars$mpg[mtcars$am==0]~mtcars$wt[mtcars$am==0]),col=2,cex=2)
abline(lm(mtcars$mpg[mtcars$am==0]~mtcars$wt[mtcars$am==0]),col=2,cex=5)
abline(lm(mtcars$mpg[mtcars$am==0]~mtcars$wt[mtcars$am==0]),col=2,lty = 3)
abline(lm(mtcars$mpg[mtcars$am==0]~mtcars$wt[mtcars$am==0]),col=2,lty = 10)
plot(mtcars$mpg~mtcars$wt,col=4+(mtcars$am==0),pch=19,xlab="Weight (lb/1000)",ylab="Miles/(US) gallon",frame=F)
abline(lm(mtcars$mpg[mtcars$am==1]~mtcars$wt[mtcars$am==1]))
abline(lm(mtcars$mpg[mtcars$am==1]~mtcars$wt[mtcars$am==1]),col=4)
abline(lm(mtcars$mpg[mtcars$am==1]~mtcars$wt[mtcars$am==1]),col=4,pch=19)
abline(lm(mtcars$mpg[mtcars$am==0]~mtcars$wt[mtcars$am==0]),col=3)
abline(lm(mtcars$mpg[mtcars$am==0]~mtcars$wt[mtcars$am==0]),col=5)
legend=c("Manual","Automatic"))
legend("topright",inset=c(0,0.2),pch=21,pt.bg=c("lightblue","red"),legend=c("Manual","Automatic"))
legend("topright",inset=c(0,0.2),pch=21,pt.bg=c(4,5),legend=c("Manual","Automatic"))
cor(mtcars$mpg, mtcars[,c(-1,-2,-8,-10,-11)])
plot(mtcars$mpg~mtcars$dispt,col=4+(mtcars$am==0),pch=19,xlab="Displacement (cu.in.)",ylab="Miles/(US) gallon",frame=F)
abline(lm(mtcars$mpg[mtcars$am==1]~mtcars$disp[mtcars$am==1]),col=4)
abline(lm(mtcars$mpg[mtcars$am==0]~mtcars$disp[mtcars$am==0]),col=5)
legend("topright",inset=c(0,0.2),pch=21,pt.bg=c(4,5),legend=c("Manual","Automatic"))
plot(mtcars$mpg~mtcars$disp,col=4+(mtcars$am==0),pch=19,xlab="Displacement (cu.in.)",ylab="Miles/(US) gallon",frame=F)
abline(lm(mtcars$mpg[mtcars$am==1]~mtcars$disp[mtcars$am==1]),col=4)
abline(lm(mtcars$mpg[mtcars$am==0]~mtcars$disp[mtcars$am==0]),col=5)
legend("topright",inset=c(0,0.2),pch=21,pt.bg=c(4,5),legend=c("Manual","Automatic"))
legend("topright",inset=c(0,1),pch=21,pt.bg=c(4,5),legend=c("Manual","Automatic"))
legend("topright",inset=c(0,0.2),pch=21,pt.bg=c(4,5),legend=c("Manual","Automatic"))
plot(mtcars$mpg~mtcars$disp,col=4+(mtcars$am==0),pch=19,xlab="Displacement (cu.in.)",ylab="Miles/(US) gallon",frame=F)
abline(lm(mtcars$mpg[mtcars$am==1]~mtcars$disp[mtcars$am==1]),col=4)
abline(lm(mtcars$mpg[mtcars$am==0]~mtcars$disp[mtcars$am==0]),col=5)
legend("topright",pch=21,pt.bg=c(4,5),legend=c("Manual","Automatic"))
plot(mtcars$mpg~mtcars$wt,col=4+(mtcars$am==0),pch=19,xlab="Weight (lb/1000)",ylab="Miles/(US) gallon",frame=F)
abline(lm(mtcars$mpg[mtcars$am==1]~mtcars$wt[mtcars$am==1]),col=4)
abline(lm(mtcars$mpg[mtcars$am==0]~mtcars$wt[mtcars$am==0]),col=5)
legend("topright",pch=21,pt.bg=c(4,5),legend=c("Manual","Automatic"))
cor(mtcars$mpg, mtcars[,c(-1,-2,-8,-10,-11)])
plot(mtcars$mpg~mtcars$hp,col=4+(mtcars$am==0),pch=19,xlab="Gross horsepower",ylab="Miles/(US) gallon",frame=F)
abline(lm(mtcars$mpg[mtcars$am==1]~mtcars$hp[mtcars$am==1]),col=4)
abline(lm(mtcars$mpg[mtcars$am==0]~mtcars$hp[mtcars$am==0]),col=5)
legend("topright",pch=21,pt.bg=c(4,5),legend=c("Manual","Automatic"))
pairs(mtcars[,c(1,3:7], main = "Motor Trend Car Road Tests", col = 7 + (mtcars$am == 0), pch = 19,cex = 2)
c(1,3:7]
pairs(mtcars[,c(1,3:7)], main = "Motor Trend Car Road Tests", col = 7 + (mtcars$am == 0), pch = 19,cex = 2)
pairs(mtcars[,c(1,3:7)], main = "Motor Trend Car Road Tests", col = 4 + (mtcars$am == 0), pch = 19,cex = 2)
pairs(mtcars[,c(1,3:7)], main = "Motor Trend Car Road Tests", col = 4 + (mtcars$am == 0)*2, pch = 19,cex = 2)
pairs(mtcars[,c(1,3:7)], main = "Motor Trend Car Road Tests", col = 4 + (mtcars$am == 0)*5, pch = 19,cex = 2)
pairs(mtcars[,c(1,3:7)], main = "Motor Trend Car Road Tests", col = 4 + (mtcars$am == 0)*4, pch = 19,cex = 2)
pairs(mtcars[,c(1,3:7)], main = "Motor Trend Car Road Tests", col = 4 + (mtcars$am == 0)*5, pch = 19,cex = 2)
boxplot(mtcars$am,mtcars$mpg)
boxplot(mtcars$am)
mtcars$am <- as.factor(mtcars$am)
levels(mtcars$am) <- c("Automatic", "Manual")
boxplot(mtcars$am,mtcars$mpg)
mtcars$a
boxplot(mtcars)
boxplot(mtcars$mpg,mtcars[,-1])
boxplot(mtcars$am,mtcars)
boxplot(mtcars$mpg~mtcars$am)
boxplot(mtcars$mpg~mtcars$am,col=2)
boxplot(mtcars$mpg~mtcars$am,col=c(1,2))
boxplot(mtcars$mpg~mtcars$am,col=c(3,2))
boxplot(mtcars$mpg~mtcars$am,col=c(5,4))
plot(mtcars$mpg~mtcars$hp,col=4+(mtcars$am==0),pch=19,xlab="Gross horsepower",ylab="Miles/(US) gallon",frame=F)
abline(lm(mtcars$mpg[mtcars$am==1]~mtcars$hp[mtcars$am==1]),col=4)
abline(lm(mtcars$mpg[mtcars$am==0]~mtcars$hp[mtcars$am==0]),col=5)
legend("topright",pch=21,pt.bg=c(4,5),legend=c("Manual","Automatic"))
plot(mtcars$mpg~mtcars$hp,col=4+(mtcars$am==0),pch=19,xlab="Gross horsepower",ylab="Miles/(US) gallon",frame=F)
abline(lm(mtcars$mpg[mtcars$am==1]~mtcars$hp[mtcars$am==1]),col=4)
abline(lm(mtcars$mpg[mtcars$am==1]~mtcars$wt[mtcars$am==1]),col=4)
abline(lm(mtcars$mpg[mtcars$am==1]~mtcars$wt[mtcars$am==1]),col=4)
plot(mtcars$mpg~mtcars$wt,col=4+(mtcars$am==0),pch=19,xlab="Weight (lb/1000)",ylab="Miles/(US) gallon",frame=F)
abline(lm(mtcars$mpg[mtcars$am==1]~mtcars$wt[mtcars$am==1]),col=4)
abline(lm(mtcars$mpg[mtcars$am==0]~mtcars$wt[mtcars$am==0]),col=1)
plot(mtcars$mpg~mtcars$wt,col=4+(mtcars$am==0),pch=19,xlab="Weight (lb/1000)",ylab="Miles/(US) gallon",frame=F)
abline(lm(mtcars$mpg[mtcars$am==1]~mtcars$wt[mtcars$am==1]),col=4)
abline(lm(mtcars$mpg[mtcars$am==0]~mtcars$wt[mtcars$am==0]),col=1)
plot(mtcars$mpg~mtcars$wt,col=4+(mtcars$am==0)*5,pch=19,xlab="Weight (lb/1000)",ylab="Miles/(US) gallon",frame=F)
abline(lm(mtcars$mpg[mtcars$am==1]~mtcars$wt[mtcars$am==1]),col=4)
abline(lm(mtcars$mpg[mtcars$am==0]~mtcars$wt[mtcars$am==0]),col=1)
abline(lm(mtcars$mpg[mtcars$am==1]~mtcars$wt[mtcars$am==1]),col=4,lwd = 2)
model<-lm(mpg~wt+disp+hp)
model<-lm(mpg~wt+disp+hp,data=mtcars)
summary(modelF)
modelF<-lm(mpg~wt+disp+hp,data=mtcars)
summary(modelF)
cor(mtcars$mpg, mtcars[,c(-1,-2,-8,-10,-11)])
plot(mtcars$mpg~mtcars$hp,col=4+(mtcars$am==0)*5,pch=19,xlab="1/4 mile time",ylab="Miles/(US) gallon",frame=F)
abline(lm(mtcars$mpg[mtcars$am==1]~mtcars$qsec[mtcars$am==1]),col=4,lwd = 2)
abline(lm(mtcars$mpg[mtcars$am==0]~mtcars$qsec[mtcars$am==0]),col=1,lwd = 2)
legend("topright",pch=21,pt.bg=c(4,5),legend=c("Manual","Automatic"))
abline(lm(mtcars$mpg[mtcars$am==1]~mtcars$qsec[mtcars$am==1]),col=4,lwd = 2)
abline(lm(mtcars$mpg[mtcars$am==0]~mtcars$qsec[mtcars$am==0]),col=1,lwd = 2)
r
plot(mtcars$mpg~mtcars$hp,col=4+(mtcars$am==0)*5,pch=19,xlab="1/4 mile time",ylab="Miles/(US) gallon",frame=F)
plot(mtcars$mpg~mtcars$hp,col=4+(mtcars$am==0)*5,pch=19,xlab="1/4 mile time",ylab="Miles/(US) gallon",frame=F)
abline(lm(mtcars$mpg[mtcars$am==1]~mtcars$qsec[mtcars$am==1]),col=4,lwd = 2)
abline(lm(mtcars$mpg[mtcars$am==1]~mtcars$hp[mtcars$am==1]),col=4,lwd = 2)
plot(mtcars$mpg~mtcars$hp,col=4+(mtcars$am==0)*5,pch=19,xlab="1/4 mile time",ylab="Miles/(US) gallon",frame=F)
abline(lm(mtcars$mpg[mtcars$am==1]~mtcars$qsec[mtcars$am==1]),col=4,lwd = 2)
legend("topright",pch=21,pt.bg=c(4,5),legend=c("Manual","Automatic"))
plot(mtcars$mpg~mtcars$hp,col=4+(mtcars$am==0)*5,pch=19,xlab="Gross horsepower",ylab="Miles/(US) gallon",frame=F)
abline(lm(mtcars$mpg[mtcars$am==1]~mtcars$hp[mtcars$am==1]),col=4,lwd = 2)
abline(lm(mtcars$mpg[mtcars$am==0]~mtcars$hp[mtcars$am==0]),col=1,lwd = 2)
legend("topright",pch=21,pt.bg=c(4,5),legend=c("Manual","Automatic"))
legend("topright",pch=21,pt.bg=c(1,4),legend=c("Manual","Automatic"))
legend("topright",pch=21,pt.bg=c(4,1),legend=c("Manual","Automatic"))
plot(mtcars$mpg~mtcars$qsec,col=4+(mtcars$am==0)*5,pch=19,xlab="1/4 mile time",ylab="Miles/(US) gallon",frame=F)
abline(lm(mtcars$mpg[mtcars$am==1]~mtcars$qsec[mtcars$am==1]),col=4,lwd = 2)
abline(lm(mtcars$mpg[mtcars$am==0]~mtcars$qsec[mtcars$am==0]),col=1,lwd = 2)
legend("topright",pch=21,pt.bg=c(4,1),legend=c("Manual","Automatic"))
legend("topleft",pch=21,pt.bg=c(4,1),legend=c("Manual","Automatic"))
modelF<-lm(mpg~wt+disp+hp+qsec,data=mtcars)
summary(modelF)
modelF<-lm(mpg~.,data=mtcars)
summary(modelF)
modelF<-step(lm(mpg~.,data=mtcars))
modelF<-step(lm(mpg~.,data=mtcars))
modelF=step(lm(mpg~.,data=mtcars))
summary(modelF)
modelF<-step(lm(mpg~.,data=mtcars),trace = 0)
summary(modelF)
boxplot(mtcars$mpg~mtcars$am,col=c(5,4))
boxplot(mtcars$mpg~mtcars$am,col=c(5,6))
boxplot(mtcars$mpg~mtcars$am,col=c(5,13))
boxplot(mtcars$mpg~mtcars$am,col=c(5,17))
boxplot(mtcars$mpg~mtcars$am,col=c(5,120))
summary(modelF)
modelF<- lm(mpg ~ factor(am):wt + factor(am):qsec, data = mtcars)
summary(modelF)
plot(mtcars$mpg~mtcars$qsec,col=4+(mtcars$am==0)*5,pch=19,xlab="1/4 mile time",ylab="Miles/(US) gallon",frame=F)
abline(lm(mtcars$mpg[mtcars$am==1]~mtcars$qsec[mtcars$am==1]),col=4,lwd = 2)
abline(lm(mtcars$mpg[mtcars$am==0]~mtcars$qsec[mtcars$am==0]),col=1,lwd = 2)
legend("downright",pch=21,pt.bg=c(4,1),legend=c("Manual","Automatic"))
```
plot(mtcars$mpg~mtcars$qsec,col=4+(mtcars$am==0)*5,pch=19,xlab="1/4 mile time",ylab="Miles/(US) gallon",frame=F)
abline(lm(mtcars$mpg[mtcars$am==1]~mtcars$qsec[mtcars$am==1]),col=4,lwd = 2)
abline(lm(mtcars$mpg[mtcars$am==0]~mtcars$qsec[mtcars$am==0]),col=1,lwd = 2)
legend("bottomright",pch=21,pt.bg=c(4,1),legend=c("Manual","Automatic"))
par(mfrow=c(1,2))
plot(mtcars$mpg~mtcars$wt,col=4+(mtcars$am==0)*5,pch=19,xlab="Weight (lb/1000)",ylab="Miles/(US) gallon",frame=F)
abline(lm(mtcars$mpg[mtcars$am==1]~mtcars$wt[mtcars$am==1]),col=4,lwd = 2)
abline(lm(mtcars$mpg[mtcars$am==0]~mtcars$wt[mtcars$am==0]),col=1,lwd = 2)
legend("topright",pch=21,pt.bg=c(4,1),legend=c("Manual","Automatic"))
par(mfrow=c(1,2))
par(mfrow=c(1,1))
str(mtcars)
summary(mtcars)
plot(mtcars$mpg~mtcars$wt,col=4+(mtcars$am==0)*5,pch=19,xlab="Weight (lb/1000)",ylab="Miles/(US) gallon",frame=F)
abline(lm(mtcars$mpg[mtcars$am==1]~mtcars$wt[mtcars$am==1]),col=4,lwd = 2)
abline(lm(mtcars$mpg[mtcars$am==0]~mtcars$wt[mtcars$am==0]),col=1,lwd = 2)
legend("topright",pch=21,pt.bg=c(4,1),legend=c("Manual","Automatic"))
mean(mtcars$mpg[mtcars$am==1])
mean(mtcars$mpg[mtcars$am==0])
summary(modelF)
mean(mtcars$mpg[mtcars$am==1])-mean(mtcars$mpg[mtcars$am==0])
round(mean(mtcars$mpg[mtcars$am==1]),2)
round(mean(mtcars$mpg[mtcars$am==1])-mean(mtcars$mpg[mtcars$am==0]),2)
summary(modelF)
str(modelF)
plot(modelF)
library("markdown", lib.loc="~/R/win-library/3.1")
library("rmarkdown", lib.loc="~/R/win-library/3.1")
library("knitr", lib.loc="~/R/win-library/3.1")
detach("package:knitr", unload=TRUE)
detach("package:rmarkdown", unload=TRUE)
detach("package:markdown", unload=TRUE)
library("ggplot2", lib.loc="~/R/win-library/3.1")
library("lattice", lib.loc="C:/Program Files/R/R-3.1.1/library")
# Clean Environment
rm(list=ls())
library(datasets)
# Load the DataSet
hpc <- read.table(file = "household_power_consumption.txt", sep = ";", skip = 66637, nrows = 2880)
setwd("~/GitHub/ExData_Plotting1")
hpc <- read.table(file = "household_power_consumption.txt", sep = ";", skip = 66637, nrows = 2880)
png(filename = "plot1.png", width = 480, height = 480,bg="transparent")
hist(hpc$V3, main="Global Active Power", xlab="Global Active Power (Kilowatts)", col="red")
dev.off()
hpc <- read.table(file = "household_power_consumption.txt", sep = ";", skip = 66637, nrows = 2880)
png(filename = "plot2.png", width = 480, height = 480,bg="transparent")
with(hpc, plot(strptime(paste(hpc$V1, hpc$V2, sep = ' '), "%d/%m/%Y %H:%M:%S"), hpc$V3, ylab="Global Active Power (Kilowatts)", xlab="", type = "l"))
dev.off()
hpc <- read.table(file = "household_power_consumption.txt", sep = ";", skip = 66637, nrows = 2880)
png(filename = "plot3.png", width = 480, height = 480,bg="transparent")
plot(strptime(paste(hpc$V1, hpc$V2, sep = ' '), "%d/%m/%Y %H:%M:%S"), hpc$V7, xlab="", ylab="Energy sub Metering", main="", type = "l", col = "black")
lines(strptime(paste(hpc$V1, hpc$V2, sep = ' '), "%d/%m/%Y %H:%M:%S"), hpc$V8, type = "l", col = "red")
lines(strptime(paste(hpc$V1, hpc$V2, sep = ' '), "%d/%m/%Y %H:%M:%S"), hpc$V9, type = "l", col = "blue")
legend("topright", lty = c(1,1), col = c("black", "red", "blue"), legend = c("Sub_metering_1", "Sub_metering_2", "Sub_metering_3"))# Close device
dev.off()
png(filename = "plot4.png", width = 480, height = 480,bg="transparent")
par(mfrow = c(2, 2))
with(hpc, plot(strptime(paste(hpc$V1, hpc$V2, sep = ' '), "%d/%m/%Y %H:%M:%S"), hpc$V3, ylab="Global Active Power", xlab="", type = "l"))
with(hpc, plot(strptime(paste(hpc$V1, hpc$V2, sep = ' '), "%d/%m/%Y %H:%M:%S"), hpc$V5, xlab="Datetime", ylab="Voltage", type = "l"))
plot(strptime(paste(hpc$V1, hpc$V2, sep = ' '), "%d/%m/%Y %H:%M:%S"), hpc$V7, xlab="", ylab="Energy sub Metering", main="", type = "l", col = "black")
lines(strptime(paste(hpc$V1, hpc$V2, sep = ' '), "%d/%m/%Y %H:%M:%S"), hpc$V8, type = "l", col = "red")
lines(strptime(paste(hpc$V1, hpc$V2, sep = ' '), "%d/%m/%Y %H:%M:%S"), hpc$V9, type = "l", col = "blue")
legend("topright", bty = "n", lty = c(1,1), col = c("black", "red", "blue"), legend = c("Sub_metering_1", "Sub_metering_2", "Sub_metering_3"))
with(hpc, plot(strptime(paste(hpc$V1, hpc$V2, sep = ' '), "%d/%m/%Y %H:%M:%S"), hpc$V4, xlab="Datetime", ylab="Global_reactive_power", type = "l"))
# Close device
dev.off()
